<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Giftly - –ë–∏–ª–µ—Ç–∏–∫–∏</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <!-- Web Block -->
    <div id="webBlock" style="display: none; position: fixed; inset: 0; z-index: 9999; background: linear-gradient(180deg, #e8f0f8 0%, #d4e4f0 100%); align-items: center; justify-content: center; flex-direction: column; padding: 40px; text-align: center;">
        <div style="font-size: 80px; margin-bottom: 20px;">üéüÔ∏è</div>
        <h1 style="color: #1a5a2e; font-size: 28px; margin-bottom: 16px;">–ë–∏–ª–µ—Ç–∏–∫–∏</h1>
        <p style="color: #388e3c; font-size: 16px; margin-bottom: 32px; max-width: 300px;">
            –û—Ç–∫—Ä–æ–π –≤ Telegram —á—Ç–æ–±—ã –ø–æ–ª—É—á–∞—Ç—å –±–∏–ª–µ—Ç–∏–∫–∏!
        </p>
        <a href="https://t.me/giftl_robot" style="background: linear-gradient(135deg, #30d158, #34c759); color: white; padding: 16px 32px; border-radius: 100px; text-decoration: none; font-weight: 600;">
            üì± –û—Ç–∫—Ä—ã—Ç—å –≤ Telegram
        </a>
    </div>

    <!-- Ambient Background -->
    <div class="ambient-bg">
        <div class="ambient-orb"></div>
        <div class="ambient-orb"></div>
        <div class="ambient-orb"></div>
        <div class="ambient-orb"></div>
    </div>

    <div class="app" id="mainApp">
        <!-- Tab Bar -->
        <nav class="bottom-nav">
            <a href="index.html" class="nav-item">
                <span class="nav-icon">üéÅ</span>
                <span class="nav-label">–ñ–µ–ª–∞–Ω–∏—è</span>
            </a>
            <a href="tasks.html" class="nav-item active">
                <span class="nav-icon">üéüÔ∏è</span>
                <span class="nav-label">–ë–∏–ª–µ—Ç—ã</span>
            </a>
            <a href="santa.html" class="nav-item">
                <span class="nav-icon">üéÖ</span>
                <span class="nav-label">–°–∞–Ω—Ç–∞</span>
            </a>
            <a href="profile.html" class="nav-item">
                <span class="nav-icon">üë§</span>
                <span class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</span>
            </a>
        </nav>

        <!-- Header with Tickets Count -->
        <header class="tickets-header">
            <div class="tickets-balance">
                <div class="ticket-icon-big">üéüÔ∏è</div>
                <div class="tickets-info">
                    <div class="tickets-count" id="ticketsCount">0</div>
                    <div class="tickets-label">–±–∏–ª–µ—Ç–∏–∫–æ–≤</div>
                </div>
            </div>
            <p class="tickets-hint">–í—ã–ø–æ–ª–Ω—è–π –∑–∞–¥–∞–Ω–∏—è ‚Äî –ø–æ–ª—É—á–∞–π –±–∏–ª–µ—Ç–∏–∫–∏ –¥–ª—è —Ä–æ–∑—ã–≥—Ä—ã—à–∞!</p>
        </header>

        <!-- Prize Banner -->
        <div class="section">
            <div class="prize-banner">
                <div class="prize-icon">üéÅ</div>
                <div class="prize-info">
                    <div class="prize-title">–†–æ–∑—ã–≥—Ä—ã—à NFT –ø–æ–¥–∞—Ä–∫–æ–≤</div>
                    <div class="prize-desc">–ö–∞–∂–¥—ã–π –±–∏–ª–µ—Ç–∏–∫ = 1 —à–∞–Ω—Å –≤—ã–∏–≥—Ä–∞—Ç—å</div>
                </div>
                <div class="prize-timer" id="prizeTimer">3–¥ 12—á</div>
            </div>
        </div>

        <!-- Tasks -->
        <div class="section">
            <div class="section-label">üìã –ó–∞–¥–∞–Ω–∏—è</div>
            <div id="tasksList" class="tasks-list">
                <div class="task-skeleton"></div>
                <div class="task-skeleton"></div>
                <div class="task-skeleton"></div>
            </div>
        </div>

        <!-- My Tickets -->
        <div class="section">
            <div class="section-label">üéüÔ∏è –ú–æ–∏ –±–∏–ª–µ—Ç–∏–∫–∏</div>
            <div id="myTickets" class="tickets-grid">
                <div class="empty-tickets">
                    <span>–ü–æ–∫–∞ –Ω–µ—Ç –±–∏–ª–µ—Ç–∏–∫–æ–≤</span>
                    <span>–í—ã–ø–æ–ª–Ω–∏ –∑–∞–¥–∞–Ω–∏–µ —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å!</span>
                </div>
            </div>
        </div>

        <div class="toast" id="toast"></div>
    </div>

    <script src="config.js"></script>
    <script src="blocked-check.js"></script>
    <script src="tasks.js"></script>
    <script>
        const tgCheck = window.Telegram?.WebApp;
        if (!tgCheck || !tgCheck.initDataUnsafe?.user) {
            document.getElementById('webBlock').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
            document.querySelector('.bottom-nav').style.display = 'none';
        }
    </script>
</body>
</html>